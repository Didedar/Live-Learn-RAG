# –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–∞–∑–¥–µ–ª–µ–Ω–Ω–æ–≥–æ —Ñ–∏–¥–±—ç–∫–∞ –±–µ–∑ –ø—Ä–æ—Ç–µ—á–µ–∫

## –û–±–∑–æ—Ä –ø—Ä–æ–±–ª–µ–º—ã

–í –∏—Å—Ö–æ–¥–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ —Ñ–∏–¥–±—ç–∫ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å–º–µ—à–∏–≤–∞–ª—Å—è —Å –æ—Å–Ω–æ–≤–Ω—ã–º–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏, —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏–ª–æ –∫ **–ø—Ä–æ—Ç–µ—á–∫–∞–º** –º–µ–∂–¥—É —Ä–∞–∑–Ω—ã–º–∏ –Ω–∞–º–µ—Ä–µ–Ω–∏—è–º–∏ –∑–∞–ø—Ä–æ—Å–æ–≤:

- –§–∏–¥–±—ç–∫ –ø–æ –≤–æ–ø—Ä–æ—Å—É Q1 –≤–ª–∏—è–ª –Ω–∞ –æ—Ç–≤–µ—Ç—ã –¥–ª—è Q2 —Å –ø–æ—Ö–æ–∂–µ–π —Å–µ–º–∞–Ω—Ç–∏–∫–æ–π
- `correction_text` –¥–æ–±–∞–≤–ª—è–ª—Å—è –∫–∞–∫ –Ω–æ–≤—ã–µ —á–∞–Ω–∫–∏ –≤ –æ—Å–Ω–æ–≤–Ω–æ–π –∏–Ω–¥–µ–∫—Å
- –û—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª–∞ –ø—Ä–∏–≤—è–∑–∫–∞ —Ñ–∏–¥–±—ç–∫–∞ –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º –Ω–∞–º–µ—Ä–µ–Ω–∏—è–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

## –ù–æ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞: –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Ö—Ä–∞–Ω–∏–ª–∏—â

### 1. –î–≤–∞ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ö—Ä–∞–Ω–∏–ª–∏—â–∞

#### `docs_index` - –¢–æ–ª—å–∫–æ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã
```
‚úÖ –°–æ–¥–µ—Ä–∂–∏—Ç: –ò—Å—Ö–æ–¥–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã –∏ –∏—Ö —á–∞–Ω–∫–∏
‚ùå –ù–ï —Å–æ–¥–µ—Ä–∂–∏—Ç: –§–∏–¥–±—ç–∫, –∫–æ—Ä—Ä–µ–∫—Ü–∏–∏, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç
üîí –ò—Å—Ç–æ—á–Ω–∏–∫: source = "original"
```

#### `feedback_store` - –ò–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ñ–∏–¥–±—ç–∫–∞
```
‚úÖ –°–æ–¥–µ—Ä–∂–∏—Ç: Intent-based —Ñ–∏–¥–±—ç–∫ —Å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏
‚ùå –ù–ï —Å–æ–¥–µ—Ä–∂–∏—Ç: –î–æ–∫—É–º–µ–Ω—Ç—ã –∏–ª–∏ –∏—Ö —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ
üîë –ü—Ä–∏–≤—è–∑–∫–∞: intent_key + evidence links
```

### 2. –°–∏—Å—Ç–µ–º–∞ Intent Keys

#### –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞–º–µ—Ä–µ–Ω–∏–π
```python
def normalize_query(query: str) -> dict:
    # –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–æ–ø-—Å–ª–æ–≤
    # –õ–µ–º–º–∞—Ç–∏–∑–∞—Ü–∏—è
    # –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Å—É—â–Ω–æ—Å—Ç–µ–π
    # –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ —Ç–æ–∫–µ–Ω–æ–≤
    return {
        'normalized_text': '–º–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ? —Ç–∞–∫–æ–µ',
        'tokens': ['–º–∞—à–∏–Ω–Ω–æ–µ', '–æ–±—É—á–µ–Ω–∏–µ', '—Ç–∞–∫–æ–µ'],
        'entities': ['NUM:2023', 'PROPER:Python'],
        'intent_key': 'sha256_hash'
    }
```

#### –î–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–ª—é—á–∏ –Ω–∞–º–µ—Ä–µ–Ω–∏–π
```
Q1: "–ß—Ç–æ —Ç–∞–∫–æ–µ –º–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ?" 
    ‚Üí intent_key: 2635f8c76444e463...

Q2: "–û–±—ä—è—Å–Ω–∏ –º–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ"
    ‚Üí intent_key: afb5f5adf1f9f6c0...

Q3: "–ö–∞–∫ –ø—Ä–∏–≥–æ—Ç–æ–≤–∏—Ç—å –ø–∞—Å—Ç—É?"
    ‚Üí intent_key: 0f35ade26fa211db...
```

### 3. –ñ—ë—Å—Ç–∫–∏–µ —Ñ–∏–ª—å—Ç—Ä—ã (Gating)

#### –£—Å–ª–æ–≤–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è —Ñ–∏–¥–±—ç–∫–∞
```python
def apply_feedback_filter(feedback, query, retrieved_docs):
    # Gate 1: Intent matching
    if feedback.intent_key != query.intent_key:
        if similarity(feedback.intent, query.intent) < TAU_INTENT:
            return False
    
    # Gate 2: Evidence overlap
    feedback_docs = {ev.doc_id for ev in feedback.evidence}
    retrieved_docs_ids = {doc.id for doc in retrieved_docs}
    if not (feedback_docs & retrieved_docs_ids):
        return False
    
    # Gate 3: User scope filtering
    if feedback.scope == 'local' and feedback.user_id != query.user_id:
        return False
    
    return True
```

### 4. –ü–µ—Ä–µ—Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑ –∫–æ–Ω—Ç–∞–º–∏–Ω–∞—Ü–∏–∏

```python
def rerank_with_feedback(docs, applicable_feedback):
    for doc in docs:
        for feedback in applicable_feedback:
            if doc.id in feedback.evidence_doc_ids:
                if feedback.label == 'reject':
                    doc.score += feedback.polarity * feedback.weight * 0.1
                elif feedback.label == 'prefer':
                    doc.score += feedback.polarity * feedback.weight * 0.1
                # –í–ê–ñ–ù–û: correction_text –ù–ï –ø–æ–ø–∞–¥–∞–µ—Ç –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç!
    
    return sorted(docs, key=lambda x: x.score, reverse=True)
```

## –ù–æ–≤—ã–µ –º–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö

### IntentKey - –ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –Ω–∞–º–µ—Ä–µ–Ω–∏—è
```sql
CREATE TABLE intent_keys (
    id VARCHAR(64) PRIMARY KEY,  -- SHA-256 hash
    normalized_text TEXT NOT NULL,
    entities JSON DEFAULT '[]',
    tokens JSON DEFAULT '[]',
    embedding JSON NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

### IntentFeedback - –ò–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ–∏–¥–±—ç–∫
```sql
CREATE TABLE intent_feedback (
    id VARCHAR(36) PRIMARY KEY,
    intent_key VARCHAR(64) NOT NULL,  -- –ñ—ë—Å—Ç–∫–∞—è –ø—Ä–∏–≤—è–∑–∫–∞ –∫ –Ω–∞–º–µ—Ä–µ–Ω–∏—é
    query_text TEXT NOT NULL,         -- –î–ª—è –æ—Ç–ª–∞–¥–∫–∏
    user_id VARCHAR(128),
    label ENUM('prefer', 'reject', 'fix', 'style'),
    polarity INTEGER,                 -- +1/-1
    weight FLOAT DEFAULT 1.0,         -- –î–æ–≤–µ—Ä–∏–µ
    scope ENUM('local', 'cluster', 'global'),
    evidence JSON DEFAULT '[]',       -- –°—Å—ã–ª–∫–∏ –Ω–∞ docs
    notes TEXT,                       -- –û–±—ä—è—Å–Ω–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    correction_text TEXT,             -- –ù–ï –ø–æ–ø–∞–¥–∞–µ—Ç –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç—ã!
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

## API Endpoints

### –ù–æ–≤—ã–µ endpoints —Å —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º

#### `/api/v1/separated/ask` - –ó–∞–ø—Ä–æ—Å —Å –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–º —Ñ–∏–¥–±—ç–∫–æ–º
```python
POST /api/v1/separated/ask
{
    "question": "–ß—Ç–æ —Ç–∞–∫–æ–µ –º–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ?",
    "user_id": "user123",
    "top_k": 6
}

Response:
{
    "message_id": "uuid",
    "answer": "...",
    "contexts": [...],  # –¢–û–õ–¨–ö–û –∏–∑ docs_index
    "feedback_applied_count": 2,
    "separation_integrity": "maintained"
}
```

#### `/api/v1/separated/feedback` - –ò–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ñ–∏–¥–±—ç–∫–∞
```python
POST /api/v1/separated/feedback
{
    "message_id": "uuid",
    "feedback_label": "reject",
    "target_doc_ids": [1, 2],
    "target_chunk_ids": [5, 6],
    "notes": "–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è —É—Å—Ç–∞—Ä–µ–ª–∞",
    "correction_text": "–ê–∫—Ç—É–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: ..."
}

Response:
{
    "status": "stored_separately",
    "feedback_id": "uuid",
    "contamination_risk": "eliminated"
}
```

#### `/api/v1/separated/health/separation` - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏
```python
GET /api/v1/separated/health/separation

Response:
{
    "separation_integrity": "HEALTHY",
    "feedback_chunks_in_docs_index": 0,    # –î–æ–ª–∂–Ω–æ –±—ã—Ç—å 0!
    "original_chunks": 1857,
    "feedback_entries": 5,
    "contamination_risk": "eliminated"
}
```

## –ê–ª–≥–æ—Ä–∏—Ç–º —Ä–∞–±–æ—Ç—ã

### 1. –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–ø—Ä–æ—Å–∞
```
User Query ‚Üí Intent Normalization ‚Üí Intent Key Generation
     ‚Üì
docs_index Retrieval (ONLY original content)
     ‚Üì
Feedback Application (intent-based gating)
     ‚Üì
Reranking (scores only, no content mixing)
     ‚Üì
LLM Generation (ONLY original contexts)
```

### 2. –•—Ä–∞–Ω–µ–Ω–∏–µ —Ñ–∏–¥–±—ç–∫–∞
```
User Feedback ‚Üí Intent Key Lookup/Creation
     ‚Üì
Evidence Linking (doc_ids, chunk_ids)
     ‚Üì
Isolated Storage in feedback_store
     ‚Üì
User Trust Score Update
```

### 3. –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ñ–∏–¥–±—ç–∫–∞
```
New Query ‚Üí Intent Key Generation
     ‚Üì
Feedback Retrieval (intent_key matching)
     ‚Üì
Gating Filters (intent + evidence + user scope)
     ‚Üì
Score Adjustments (NO content contamination)
```

## –ì–∞—Ä–∞–Ω—Ç–∏–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

### ‚úÖ –ß—Ç–æ –ì–ê–†–ê–ù–¢–ò–†–û–í–ê–ù–ù–û –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–æ

1. **–ü—Ä–æ—Ç–µ—á–∫–∏ –º–µ–∂–¥—É –Ω–∞–º–µ—Ä–µ–Ω–∏—è–º–∏**
   - –§–∏–¥–±—ç–∫ –ø–æ ML –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ –∫—É–ª–∏–Ω–∞—Ä–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã
   - –ñ—ë—Å—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ intent_key

2. **–ö–æ–Ω—Ç–∞–º–∏–Ω–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–≤**
   - `correction_text` –ù–ò–ö–û–ì–î–ê –Ω–µ –ø–æ–ø–∞–¥–∞–µ—Ç –≤ LLM –∫–æ–Ω—Ç–µ–∫—Å—Ç—ã
   - –¢–æ–ª—å–∫–æ `source="original"` —á–∞–Ω–∫–∏ –≤ retrieval

3. **–°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–µ –∫–æ–ª–ª–∏–∑–∏–∏**
   - –ü–æ—Ö–æ–∂–∏–µ —Ç–µ–º—ã –∏–º–µ—é—Ç —Ä–∞–∑–Ω—ã–µ intent_key
   - –§–∏–¥–±—ç–∫ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —Ç–æ—á–Ω–æ–º/–±–ª–∏–∑–∫–æ–º —Å–æ–≤–ø–∞–¥–µ–Ω–∏–∏ –Ω–∞–º–µ—Ä–µ–Ω–∏–π

4. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –ø—Ä–æ—Ç–µ—á–∫–∏**
   - `scope="local"` –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç —Ñ–∏–¥–±—ç–∫ –æ–¥–Ω–∏–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º
   - –ò–∑–æ–ª—è—Ü–∏—è –º–µ–∂–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏

### üõ°Ô∏è –ú–µ—Ö–∞–Ω–∏–∑–º—ã –∑–∞—â–∏—Ç—ã

1. **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ**
   ```python
   # docs_index - —Ç–æ–ª—å–∫–æ —ç—Ç–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–æ
   chunk.source = "original"
   
   # feedback_store - –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ
   feedback.intent_key = required_field
   ```

2. **–í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ —É—Ä–æ–≤–Ω–µ –∫–æ–¥–∞**
   ```python
   def retrieve_from_docs_only():
       return chunks.filter(source="original")  # –ñ—ë—Å—Ç–∫–∏–π —Ñ–∏–ª—å—Ç—Ä
   ```

3. **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö constraints**
   ```sql
   -- –õ–æ–≥–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏
   CREATE VIEW separation_integrity_check AS
   SELECT 
       COUNT(CASE WHEN source = 'user_feedback' THEN 1 END) as contamination
   FROM chunks;
   ```

## –ú–∏–≥—Ä–∞—Ü–∏—è –∏ —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ

### 1. –ú–∏–≥—Ä–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
```bash
# –ü—Ä–∏–º–µ–Ω–∏—Ç—å –Ω–æ–≤—ã–µ —Ç–∞–±–ª–∏—Ü—ã
python manage.py migrate 006_separated_feedback_tables.sql

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å
curl /api/v1/separated/health/separation
```

### 2. –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ –Ω–æ–≤—ã–µ endpoints
```python
# –°—Ç–∞—Ä—ã–π —Å–ø–æ—Å–æ–± (—Å –ø—Ä–æ—Ç–µ—á–∫–∞–º–∏)
POST /api/v1/ask
POST /api/v1/feedback

# –ù–æ–≤—ã–π —Å–ø–æ—Å–æ–± (–±–µ–∑ –ø—Ä–æ—Ç–µ—á–µ–∫) 
POST /api/v1/separated/ask
POST /api/v1/separated/feedback
```

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏
```bash
# –ó–∞–ø—É—Å–∫ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏
python separated_feedback_demo.py

# –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:
# ‚úÖ docs_index —á–∏—Å—Ç –æ—Ç –∫–æ–Ω—Ç–∞–º–∏–Ω–∞—Ü–∏–∏
# ‚úÖ –ü—Ä–æ—Ç–µ—á–µ–∫ –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ - —Ñ–∏–¥–±—ç–∫ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω
# ‚úÖ –ì–µ–π—Ç–∏–Ω–≥ —Ä–∞–±–æ—Ç–∞–µ—Ç - —Ñ–∏–¥–±—ç–∫ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –∫ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–º –Ω–∞–º–µ—Ä–µ–Ω–∏—è–º
# üèÜ –û—Ü–µ–Ω–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏: 100%
```

## –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ò–Ω–¥–µ–∫—Å—ã –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞
```sql
-- –ë—ã—Å—Ç—Ä—ã–π –ø–æ–∏—Å–∫ —Ñ–∏–¥–±—ç–∫–∞ –ø–æ –Ω–∞–º–µ—Ä–µ–Ω–∏—è–º
INDEX idx_intent_feedback_intent_user (intent_key, user_id)
INDEX idx_intent_feedback_scope_intent (scope, intent_key)

-- –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏
INDEX idx_chunks_source (source)
```

### –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ intent_key
```python
# –ö—ç—à –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –Ω–∞–º–µ—Ä–µ–Ω–∏–π
@cache(ttl=3600)
def get_or_create_intent_key(query: str) -> str:
    return intent_processor.process_and_store_intent(query)
```

### TTL –∏ –æ—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä–æ–≥–æ —Ñ–∏–¥–±—ç–∫–∞
```sql
-- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä–æ–≥–æ —Ñ–∏–¥–±—ç–∫–∞
DELETE FROM intent_feedback 
WHERE created_at < NOW() - INTERVAL 30 DAY
  AND scope = 'local';
```

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –º–µ—Ç—Ä–∏–∫–∏

### –ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏
```python
metrics = {
    "separation_integrity": "HEALTHY",  # HEALTHY | CONTAMINATED
    "feedback_contamination_count": 0,   # –î–æ–ª–∂–Ω–æ –±—ã—Ç—å 0
    "intent_coverage": 0.85,            # –î–æ–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤ —Å —Ñ–∏–¥–±—ç–∫–æ–º
    "gating_efficiency": 0.92,          # –î–æ–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ñ–∏–¥–±—ç–∫–∞
    "user_feedback_quality": 0.78       # –°—Ä–µ–¥–Ω–∏–π trust_score
}
```

### –ê–ª–µ—Ä—Ç—ã
```yaml
alerts:
  - name: "Feedback Contamination Detected"
    condition: feedback_chunks_in_docs_index > 0
    severity: CRITICAL
    
  - name: "Intent Key Missing"
    condition: feedback_without_intent_key > 0
    severity: HIGH
    
  - name: "Low Separation Integrity"
    condition: separation_integrity != "HEALTHY"
    severity: CRITICAL
```

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ù–æ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ **–≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ –∏—Å–∫–ª—é—á–∞–µ—Ç –ø—Ä–æ—Ç–µ—á–∫–∏** –º–µ–∂–¥—É —Ä–∞–∑–Ω—ã–º–∏ –Ω–∞–º–µ—Ä–µ–Ω–∏—è–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∑–∞ —Å—á—ë—Ç:

1. **–°—Ç—Ä–æ–≥–æ–≥–æ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è —Ö—Ä–∞–Ω–∏–ª–∏—â** - docs_index vs feedback_store
2. **Intent-based targeting** - —Ñ–∏–¥–±—ç–∫ –ø—Ä–∏–≤—è–∑–∞–Ω –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º –Ω–∞–º–µ—Ä–µ–Ω–∏—è–º
3. **–ñ—ë—Å—Ç–∫–∏—Ö —Ñ–∏–ª—å—Ç—Ä–æ–≤** - –º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏–º–µ–Ω–∏–º–æ—Å—Ç–∏ —Ñ–∏–¥–±—ç–∫–∞
4. **–ò–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–µ—Ä–µ—Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏—è** - –≤–ª–∏—è–Ω–∏–µ —Ç–æ–ª—å–∫–æ –Ω–∞ –ø–æ—Ä—è–¥–æ–∫, –Ω–µ –Ω–∞ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

–°–∏—Å—Ç–µ–º–∞ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç **–¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∏ –ø—Ä–æ–∑—Ä–∞—á–Ω–æ–µ** –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ñ–∏–¥–±—ç–∫–∞ –±–µ–∑ —Ä–∏—Å–∫–∞ –∫–æ–Ω—Ç–∞–º–∏–Ω–∞—Ü–∏–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–≤ –∏–ª–∏ –ø—Ä–æ—Ç–µ—á–µ–∫ –º–µ–∂–¥—É —Ä–∞–∑–Ω—ã–º–∏ —Ç–∏–ø–∞–º–∏ –∑–∞–ø—Ä–æ—Å–æ–≤.


